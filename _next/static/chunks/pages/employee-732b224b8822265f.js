(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678],{1897:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/employee",function(){return n(3527)}])},3527:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var a=n(5893),s=n(7294),o=n(1664),i=n.n(o),l=n(3376),r=n(3377);let d=()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),n=Array.from({length:t},(e,t)=>t+1),[a,o]=(0,s.useState)({}),[i,d]=(0,s.useState)(!1),[c,m]=(0,s.useState)(null),[h,_]=(0,s.useState)(null),[u,p]=(0,s.useState)([]),[f,x]=(0,s.useState)([]),[y,g]=(0,s.useState)([]),j=async()=>{let e=await l.x.shift.$get().catch(r.F);if(null!=e){p(e);let t=[...new Set(e.map(e=>e.id))];g(t)}},v=async()=>{let e=await l.x.fixedshift.$get().catch(r.F);null!=e&&x(e)},N=async(e,t,n,a)=>{await l.x.fixedshift.post({body:{id:e,date:t,starttime:n,endtime:a}})},b=async(e,t)=>{await l.x.fixedshift.delete({body:{id:e,date:t}})};return{date:e,daysArray:n,weekDays:["日","月","火","水","木","金","土"],holidays:a,setHolidays:o,isModalOpen:i,selectedDate:c,editingShift:h,setEditingShift:_,shifts:u,fixedShifts:f,employees:y,openModal:e=>{m(e),d(!0)},closeModal:()=>{d(!1)},fetchShift:j,fetchFixedShift:v,createFixedShift:N,deleteFixedShift:b,formatTime:e=>"".concat(Math.floor(e).toString().padStart(2,"0"),":").concat((e%1==.5?30:0).toString().padStart(2,"0"))}};var c=n(1733),m=n(9750),h=n.n(m);let _=()=>(0,a.jsx)("div",{className:h().logoContainer,children:(0,a.jsx)("h1",{className:h().logo,children:"シフトボード"})}),u=()=>(0,a.jsx)("nav",{className:h().nav,children:(0,a.jsx)(i(),{href:c.V.$url(),className:h().navItem,children:"ホーム"})}),p=()=>(0,a.jsxs)("div",{className:h().viewOptions,children:[(0,a.jsx)("button",{className:h().viewButton,children:"週表示"}),(0,a.jsx)("button",{className:h().viewButton,children:"月表示"})]}),f=()=>(0,a.jsxs)("header",{className:h().header,children:[(0,a.jsx)(_,{}),(0,a.jsx)(u,{}),(0,a.jsx)(p,{})]}),x=e=>{let{date:t,day:n,holidays:s,openModal:o}=e,i=new Date(t.getFullYear(),t.getMonth(),n),l=i.getDay(),r="".concat(i.getFullYear(),"-").concat((i.getMonth()+1).toString().padStart(2,"0"),"-").concat(n.toString().padStart(2,"0")),c=!!s[r],{weekDays:m}=d();return(0,a.jsxs)("th",{className:c||6===l||0===l?h().holiday:"",onClick:()=>o(n.toString()),children:[n," (",m[l],")"]})},y=e=>{let{date:t,daysArray:n,holidays:s,openModal:o}=e;return(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"".concat(t.getFullYear(),"年 ").concat(t.getMonth()+1,"月")}),n.map(e=>(0,a.jsx)(x,{date:t,day:e,holidays:s,openModal:o},e))]})})},g=e=>{let{name:t}=e;return(0,a.jsx)("td",{className:h().employeeName,children:t})},j=e=>{let{shift:t,onDelete:n}=e;return(0,a.jsx)("span",{className:"".concat(h().redText," ").concat(h().clickableRedText),onClick:()=>{window.confirm("この確定シフトを取り消しますか？")&&n()},children:"".concat(t.starttime," - ").concat(t.endtime)})},v=e=>{let{shift:t,onCreateFixed:n}=e;return(0,a.jsx)("span",{onClick:async()=>{await n()},children:"".concat(t.starttime," - ").concat(t.endtime)})},N=e=>{let{employee:t,day:n,shifts:s,fixedShifts:o,deleteFixedShift:i,createFixedShift:l}=e,r=s.find(e=>e.id===t&&e.date===n.toString()),d=o.find(e=>e.id===t&&e.date===n.toString());return d?(0,a.jsx)(j,{shift:d,onDelete:()=>i(t,n.toString())}):r?(0,a.jsx)(v,{shift:r,onCreateFixed:()=>l(t,n.toString(),r.starttime,r.endtime)}):null},b=e=>{let{employees:t,daysArray:n,shifts:s,fixedShifts:o,deleteFixedShift:i,createFixedShift:l}=e;return(0,a.jsx)("tbody",{children:t.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)(g,{name:e}),n.map(t=>(0,a.jsx)("td",{children:(0,a.jsx)(N,{employee:e,day:t,shifts:s,fixedShifts:o,deleteFixedShift:i,createFixedShift:l})},t))]},e))})};var S=n(1374),T=n.n(S),w=()=>{let{date:e,daysArray:t,weekDays:n,holidays:o,setHolidays:i,isModalOpen:l,selectedDate:r,editingShift:c,setEditingShift:m,shifts:h,fixedShifts:_,employees:u,openModal:p,closeModal:x,fetchShift:g,fetchFixedShift:j,createFixedShift:v,deleteFixedShift:N,formatTime:S}=d();return(0,s.useEffect)(()=>{let e=setInterval(()=>{g(),j()},100);return()=>{clearInterval(e)}},[g,j]),(0,s.useEffect)(()=>{fetch("https://holidays-jp.github.io/api/v1/date.json").then(e=>e.json()).then(e=>{i(e)}).catch(e=>{console.error("Failed to fetch holidays:",e)})},[i]),(0,a.jsxs)("div",{className:T().container,children:[(0,a.jsx)(f,{}),(0,a.jsxs)("table",{className:T().table,children:[(0,a.jsx)(y,{date:e,daysArray:t,holidays:o,openModal:p}),(0,a.jsx)(b,{employees:u,daysArray:t,shifts:h,fixedShifts:_,deleteFixedShift:N,createFixedShift:v})]}),l&&(0,a.jsx)("div",{className:T().modalOverlay,children:(0,a.jsxs)("div",{className:T().modal,children:[(0,a.jsx)("button",{onClick:x,children:"閉じる"}),null!==r&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{children:[r,"日(",n[new Date(e.getFullYear(),e.getMonth(),Number(r)).getDay()],")のシフト詳細"]}),(0,a.jsxs)("table",{className:T().timeTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"名前"}),Array.from({length:30},(e,t)=>10+.5*t).map(e=>(0,a.jsxs)("th",{children:[Math.floor(e),":",e%1==0?"00":"30"]},e))]})}),(0,a.jsx)("tbody",{children:u.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e}),Array.from({length:30},(e,t)=>10+.5*t).map(t=>{let n=Math.floor(t),s=t%1==0?0:30,o=h.find(t=>t.id===e&&t.date===r),[i,l]=(null==o?void 0:o.starttime.split(":").map(Number))||[0,0],[d,u]=(null==o?void 0:o.endtime.split(":").map(Number))||[0,0],p=_.find(t=>t.id===e&&t.date===r),[f,x]=(null==p?void 0:p.starttime.split(":").map(Number))||[0,0],[y,g]=(null==p?void 0:p.endtime.split(":").map(Number))||[0,0],j=(i<n||i===n&&l<=s)&&(d>n||d===n&&u>s),N=(null==c?void 0:c.employeeId)===e&&"string"==typeof(null==c?void 0:c.startHour)&&"string"==typeof(null==c?void 0:c.endHour)&&parseFloat(c.startHour)<=t&&parseFloat(c.endHour)>t;return(0,a.jsx)("td",{className:N?T().editingTime:(f<n||f===n&&x<=s)&&(y>n||y===n&&g>s)?T().editingTime:j?T().shiftTime:T().timeCell,onMouseDown:()=>{j&&m({employeeId:e,startHour:t.toString()})},onMouseEnter:()=>{c&&c.employeeId===e&&(t>=i&&(t<d||t===d&&s<u)?m(e=>e?{employeeId:e.employeeId,startHour:e.startHour,endHour:t.toString()}:null):m(null))},onMouseUp:()=>{if(c&&"string"==typeof c.startHour&&""!==c.startHour.trim()&&"string"==typeof c.endHour&&""!==c.endHour.trim()){let t=S(parseFloat(c.startHour)),n=S(parseFloat(c.endHour));v(e,r,t,n),m(null)}},children:c&&c.employeeId===e&&parseInt(c.startHour,10)<=t&&("string"!=typeof c.endHour||parseInt(c.endHour,10)>t)?(0,a.jsx)("div",{className:T().editingTimeIndicator}):null},t)})]},e))})]})]})]})})]})}},9750:function(e){e.exports={clearButtonContainer:"shiftcomponents_clearButtonContainer__ECrlI",clearButton:"shiftcomponents_clearButton___8Z4S",selectedDaysSection:"shiftcomponents_selectedDaysSection__yhF56",addButton:"shiftcomponents_addButton__fh7Vc",closeButtonContainer:"shiftcomponents_closeButtonContainer__LvZlH",timespace:"shiftcomponents_timespace__T7_sK",shiftsubmitbutton:"shiftcomponents_shiftsubmitbutton__dKqmo",deleteShiftButton:"shiftcomponents_deleteShiftButton__nl2Jt",monthNavigation:"shiftcomponents_monthNavigation___uN0r",navButton:"shiftcomponents_navButton__Xh_I6",calendarDay:"shiftcomponents_calendarDay__qLp0G",dayLabel:"shiftcomponents_dayLabel__MwLE_",logoContainer:"shiftcomponents_logoContainer__OKkJ_",logo:"shiftcomponents_logo__e7T9n",nav:"shiftcomponents_nav__3AOnq",navItem:"shiftcomponents_navItem__ZuEy1",viewOptions:"shiftcomponents_viewOptions__WcyE_",viewButton:"shiftcomponents_viewButton__1LdBU",header:"shiftcomponents_header__qbxjR",holiday:"shiftcomponents_holiday__FbfgS",employeeName:"shiftcomponents_employeeName__LC0kM",redText:"shiftcomponents_redText__8bkvY",clickableRedText:"shiftcomponents_clickableRedText__mdhWc"}},1374:function(e){e.exports={container:"EmployeeTask_container__v_sj_",table:"EmployeeTask_table__1JDcJ",modalOverlay:"EmployeeTask_modalOverlay__cgzmE",modal:"EmployeeTask_modal__Gyle0",shiftBar:"EmployeeTask_shiftBar__pzGlG",timeTable:"EmployeeTask_timeTable__hRt4i",timeCell:"EmployeeTask_timeCell__eJIjd",shiftTime:"EmployeeTask_shiftTime__NkD_N",editingTimeIndicator:"EmployeeTask_editingTimeIndicator__5crLm",editingTime:"EmployeeTask_editingTime__qfq_N"}}},function(e){e.O(0,[664,774,888,179],function(){return e(e.s=1897)}),_N_E=e.O()}]);