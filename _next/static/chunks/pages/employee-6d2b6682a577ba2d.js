(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678],{1897:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/employee",function(){return n(3527)}])},3527:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var a=n(5893),o=n(7294),s=n(1664),i=n.n(s),l=n(3376),r=n(3377);let d=()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),n=Array.from({length:t},(e,t)=>t+1),[a,s]=(0,o.useState)({}),[i,d]=(0,o.useState)(!1),[c,m]=(0,o.useState)(null),[_,h]=(0,o.useState)(null),[u,p]=(0,o.useState)([]),[f,y]=(0,o.useState)([]),[x,g]=(0,o.useState)([]),j=async()=>{let e=await l.x.shift.$get().catch(r.F);if(null!=e){p(e);let t=[...new Set(e.map(e=>e.id))];g(t)}},v=async()=>{let e=await l.x.fixedshift.$get().catch(r.F);null!=e&&y(e)},N=async(e,t,n,a)=>{await l.x.fixedshift.post({body:{id:e,date:t,starttime:n,endtime:a}})},T=async(e,t)=>{await l.x.fixedshift.delete({body:{id:e,date:t}})};return{date:e,daysArray:n,weekDays:["日","月","火","水","木","金","土"],holidays:a,setHolidays:s,isModalOpen:i,selectedDate:c,editingShift:_,setEditingShift:h,shifts:u,fixedShifts:f,employees:x,openModal:e=>{m(e),d(!0)},closeModal:()=>{d(!1)},fetchShift:j,fetchFixedShift:v,createFixedShift:N,deleteFixedShift:T,formatTime:e=>"".concat(Math.floor(e).toString().padStart(2,"0"),":").concat((e%1==.5?30:0).toString().padStart(2,"0"))}};var c=n(1733),m=n(9750),_=n.n(m);let h=()=>(0,a.jsx)("div",{className:_().logoContainer,children:(0,a.jsx)("h1",{className:_().logo,children:"シフトボード"})}),u=()=>(0,a.jsx)("nav",{className:_().nav,children:(0,a.jsx)(i(),{href:c.V.$url(),className:_().navItem,children:"ホーム"})}),p=()=>(0,a.jsxs)("div",{className:_().viewOptions,children:[(0,a.jsx)("button",{className:_().viewButton,children:"週表示"}),(0,a.jsx)("button",{className:_().viewButton,children:"月表示"})]}),f=()=>(0,a.jsxs)("header",{className:_().header,children:[(0,a.jsx)(h,{}),(0,a.jsx)(u,{}),(0,a.jsx)(p,{})]}),y=e=>{let{date:t,day:n,holidays:o,openModal:s}=e,i=new Date(t.getFullYear(),t.getMonth(),n),l=i.getDay(),r="".concat(i.getFullYear(),"-").concat((i.getMonth()+1).toString().padStart(2,"0"),"-").concat(n.toString().padStart(2,"0")),c=!!o[r],{weekDays:m}=d();return(0,a.jsxs)("th",{className:c||6===l||0===l?_().holiday:"",onClick:()=>s(n.toString()),children:[n," (",m[l],")"]})},x=e=>{let{date:t,daysArray:n,holidays:o,openModal:s}=e;return(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"".concat(t.getFullYear(),"年 ").concat(t.getMonth()+1,"月")}),n.map(e=>(0,a.jsx)(y,{date:t,day:e,holidays:o,openModal:s},e))]})})};var g=n(1374),j=n.n(g),v=()=>{let{date:e,daysArray:t,weekDays:n,holidays:s,setHolidays:i,isModalOpen:l,selectedDate:r,editingShift:c,setEditingShift:m,shifts:_,fixedShifts:h,employees:u,openModal:p,closeModal:y,fetchShift:g,fetchFixedShift:v,createFixedShift:N,deleteFixedShift:T,formatTime:b}=d();return(0,o.useEffect)(()=>{let e=setInterval(()=>{g(),v()},100);return()=>{clearInterval(e)}},[g,v]),(0,o.useEffect)(()=>{fetch("https://holidays-jp.github.io/api/v1/date.json").then(e=>e.json()).then(e=>{i(e)}).catch(e=>{console.error("Failed to fetch holidays:",e)})},[i]),(0,a.jsxs)("div",{className:j().container,children:[(0,a.jsx)(f,{}),(0,a.jsxs)("table",{className:j().table,children:[(0,a.jsx)(x,{date:e,daysArray:t,holidays:s,openModal:p}),(0,a.jsx)("tbody",{children:u.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:j().employeeName,children:e}),t.map(t=>{let n=_.find(n=>n.id===e&&n.date===t.toString()),o=h.find(n=>n.id===e&&n.date===t.toString()),s=o?(0,a.jsx)("span",{className:"".concat(j().redText," ").concat(j().clickableRedText),onClick:()=>{window.confirm("この確定シフトを取り消しますか？")&&T(e,t.toString())},children:"".concat(o.starttime," - ").concat(o.endtime)}):n?(0,a.jsx)("span",{onClick:async()=>{await N(e,t.toString(),n.starttime,n.endtime)},children:"".concat(n.starttime," - ").concat(n.endtime)}):null;return(0,a.jsx)("td",{children:s},t)})]},e))})]}),l&&(0,a.jsx)("div",{className:j().modalOverlay,children:(0,a.jsxs)("div",{className:j().modal,children:[(0,a.jsx)("button",{onClick:y,children:"閉じる"}),null!==r&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{children:[r,"日(",n[new Date(e.getFullYear(),e.getMonth(),Number(r)).getDay()],")のシフト詳細"]}),(0,a.jsxs)("table",{className:j().timeTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"名前"}),Array.from({length:30},(e,t)=>10+.5*t).map(e=>(0,a.jsxs)("th",{children:[Math.floor(e),":",e%1==0?"00":"30"]},e))]})}),(0,a.jsx)("tbody",{children:u.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e}),Array.from({length:30},(e,t)=>10+.5*t).map(t=>{let n=Math.floor(t),o=t%1==0?0:30,s=_.find(t=>t.id===e&&t.date===r),[i,l]=(null==s?void 0:s.starttime.split(":").map(Number))||[0,0],[d,u]=(null==s?void 0:s.endtime.split(":").map(Number))||[0,0],p=h.find(t=>t.id===e&&t.date===r),[f,y]=(null==p?void 0:p.starttime.split(":").map(Number))||[0,0],[x,g]=(null==p?void 0:p.endtime.split(":").map(Number))||[0,0],v=(i<n||i===n&&l<=o)&&(d>n||d===n&&u>o),T=(null==c?void 0:c.employeeId)===e&&"string"==typeof(null==c?void 0:c.startHour)&&"string"==typeof(null==c?void 0:c.endHour)&&parseFloat(c.startHour)<=t&&parseFloat(c.endHour)>t;return(0,a.jsx)("td",{className:T?j().editingTime:(f<n||f===n&&y<=o)&&(x>n||x===n&&g>o)?j().editingTime:v?j().shiftTime:j().timeCell,onMouseDown:()=>{v&&m({employeeId:e,startHour:t.toString()})},onMouseEnter:()=>{c&&c.employeeId===e&&(t>=i&&(t<d||t===d&&o<u)?m(e=>e?{employeeId:e.employeeId,startHour:e.startHour,endHour:t.toString()}:null):m(null))},onMouseUp:()=>{if(c&&"string"==typeof c.startHour&&""!==c.startHour.trim()&&"string"==typeof c.endHour&&""!==c.endHour.trim()){let t=b(parseFloat(c.startHour)),n=b(parseFloat(c.endHour));N(e,r,t,n),m(null)}},children:c&&c.employeeId===e&&parseInt(c.startHour,10)<=t&&("string"!=typeof c.endHour||parseInt(c.endHour,10)>t)?(0,a.jsx)("div",{className:j().editingTimeIndicator}):null},t)})]},e))})]})]})]})})]})}},9750:function(e){e.exports={clearButtonContainer:"shiftcomponents_clearButtonContainer__ECrlI",clearButton:"shiftcomponents_clearButton___8Z4S",selectedDaysSection:"shiftcomponents_selectedDaysSection__yhF56",addButton:"shiftcomponents_addButton__fh7Vc",closeButtonContainer:"shiftcomponents_closeButtonContainer__LvZlH",timespace:"shiftcomponents_timespace__T7_sK",shiftsubmitbutton:"shiftcomponents_shiftsubmitbutton__dKqmo",deleteShiftButton:"shiftcomponents_deleteShiftButton__nl2Jt",monthNavigation:"shiftcomponents_monthNavigation___uN0r",navButton:"shiftcomponents_navButton__Xh_I6",calendarDay:"shiftcomponents_calendarDay__qLp0G",dayLabel:"shiftcomponents_dayLabel__MwLE_",logoContainer:"shiftcomponents_logoContainer__OKkJ_",logo:"shiftcomponents_logo__e7T9n",nav:"shiftcomponents_nav__3AOnq",navItem:"shiftcomponents_navItem__ZuEy1",viewOptions:"shiftcomponents_viewOptions__WcyE_",viewButton:"shiftcomponents_viewButton__1LdBU",header:"shiftcomponents_header__qbxjR",holiday:"shiftcomponents_holiday__FbfgS"}},1374:function(e){e.exports={container:"EmployeeTask_container__v_sj_",table:"EmployeeTask_table__1JDcJ",employeeName:"EmployeeTask_employeeName__oip2U",modalOverlay:"EmployeeTask_modalOverlay__cgzmE",modal:"EmployeeTask_modal__Gyle0",shiftBar:"EmployeeTask_shiftBar__pzGlG",timeTable:"EmployeeTask_timeTable__hRt4i",timeCell:"EmployeeTask_timeCell__eJIjd",shiftTime:"EmployeeTask_shiftTime__NkD_N",editingTimeIndicator:"EmployeeTask_editingTimeIndicator__5crLm",editingTime:"EmployeeTask_editingTime__qfq_N",redText:"EmployeeTask_redText__VqJ1_",clickableRedText:"EmployeeTask_clickableRedText__mMf6i"}}},function(e){e.O(0,[664,774,888,179],function(){return e(e.s=1897)}),_N_E=e.O()}]);