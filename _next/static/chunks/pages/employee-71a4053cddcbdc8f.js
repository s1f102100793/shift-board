(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678],{1897:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/employee",function(){return a(7132)}])},7132:function(e,t,a){"use strict";a.r(t);var l=a(5893),n=a(7294),i=a(3376),r=a(3377),s=a(1374),o=a.n(s);t.default=()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),a=Array.from({length:t},(e,t)=>t+1),s=["日","月","火","水","木","金","土"],[d,c]=(0,n.useState)({}),[m,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(null),[_,y]=(0,n.useState)(null),f=e=>{p(e),u(!0)},[g,x]=(0,n.useState)([]),[j,T]=(0,n.useState)([]),[N,E]=(0,n.useState)([]),v=async()=>{let e=await i.x.shift.$get().catch(r.F);if(console.log(e),null!=e){x(e);let t=[...new Set(e.map(e=>e.id))];E(t)}},S=async()=>{let e=await i.x.fixedshift.$get().catch(r.F);null!=e&&T(e)},b=async(e,t,a,l)=>{await i.x.fixedshift.post({body:{id:e,date:t,starttime:a,endtime:l}})};(0,n.useEffect)(()=>{let e=setInterval(()=>{v(),S()},100);return()=>{clearInterval(e)}},[]),(0,n.useEffect)(()=>{fetch("https://holidays-jp.github.io/api/v1/date.json").then(e=>e.json()).then(e=>{c(e)}).catch(e=>{console.error("Failed to fetch holidays:",e)})},[]);let k=e=>"".concat(Math.floor(e).toString().padStart(2,"0"),":").concat((e%1==.5?30:0).toString().padStart(2,"0"));return(0,l.jsxs)("div",{className:o().container,children:[(0,l.jsxs)("table",{className:o().table,children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"".concat(e.getFullYear(),"年 ").concat(e.getMonth()+1,"月")}),a.map(t=>{let a=new Date(e.getFullYear(),e.getMonth(),t),n=a.getDay(),i="".concat(a.getFullYear(),"-").concat((a.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.toString().padStart(2,"0")),r=!!d[i];return(0,l.jsxs)("th",{className:r||6===n||0===n?o().holiday:"",onClick:()=>f(t.toString()),children:[t," (",s[n],")"]},t)})]})}),(0,l.jsx)("tbody",{children:N.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:o().employeeName,children:e}),a.map(t=>{let a;let n=g.find(a=>a.id===e&&a.date===t.toString()),i=j.find(a=>a.id===e&&a.date===t.toString());return i?a=(0,l.jsx)("span",{className:o().redText,children:"".concat(i.starttime," - ").concat(i.endtime)}):n&&(a="".concat(n.starttime," - ").concat(n.endtime)),(0,l.jsx)("td",{children:a},t)})]},e))})]}),m&&(0,l.jsx)("div",{className:o().modalOverlay,children:(0,l.jsxs)("div",{className:o().modal,children:[(0,l.jsx)("button",{onClick:()=>{u(!1)},children:"閉じる"}),null!==h&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("h2",{children:[h,"日(",s[new Date(e.getFullYear(),e.getMonth(),Number(h)).getDay()],")のシフト詳細"]}),(0,l.jsxs)("table",{className:o().timeTable,children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"名前"}),Array.from({length:30},(e,t)=>10+.5*t).map(e=>(0,l.jsxs)("th",{children:[Math.floor(e),":",e%1==0?"00":"30"]},e))]})}),(0,l.jsx)("tbody",{children:N.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:e}),Array.from({length:30},(e,t)=>10+.5*t).map(t=>{let a=Math.floor(t),n=t%1==0?0:30,i=g.find(t=>t.id===e&&t.date===h),[r,s]=(null==i?void 0:i.starttime.split(":").map(Number))||[0,0],[d,c]=(null==i?void 0:i.endtime.split(":").map(Number))||[0,0],m=j.find(t=>t.id===e&&t.date===h),[u,p]=(null==m?void 0:m.starttime.split(":").map(Number))||[0,0],[f,x]=(null==m?void 0:m.endtime.split(":").map(Number))||[0,0],T=(r<a||r===a&&s<=n)&&(d>a||d===a&&c>n),N=(null==_?void 0:_.employeeId)===e&&"string"==typeof(null==_?void 0:_.startHour)&&"string"==typeof(null==_?void 0:_.endHour)&&parseFloat(_.startHour)<=t&&parseFloat(_.endHour)>t;return(0,l.jsx)("td",{className:N?o().editingTime:(u<a||u===a&&p<=n)&&(f>a||f===a&&x>n)?o().editingTime:T?o().shiftTime:o().timeCell,onMouseDown:()=>{T&&y({employeeId:e,startHour:t.toString()})},onMouseEnter:()=>{_&&_.employeeId===e&&(t>=r&&(t<d||t===d&&n<c)?y(e=>e?{employeeId:e.employeeId,startHour:e.startHour,endHour:t.toString()}:null):y(null))},onMouseUp:()=>{if(_&&"string"==typeof _.startHour&&""!==_.startHour.trim()&&"string"==typeof _.endHour&&""!==_.endHour.trim()){let t=k(parseFloat(_.startHour)),a=k(parseFloat(_.endHour));b(e,h,t,a),y(null)}},children:_&&_.employeeId===e&&parseInt(_.startHour,10)<=t&&("string"!=typeof _.endHour||parseInt(_.endHour,10)>t)?(0,l.jsx)("div",{className:o().editingTimeIndicator}):null},t)})]},e))})]})]})]})})]})}},1374:function(e){e.exports={container:"EmployeeTask_container__v_sj_",table:"EmployeeTask_table__1JDcJ",holiday:"EmployeeTask_holiday__V6nvt",employeeName:"EmployeeTask_employeeName__oip2U",modalOverlay:"EmployeeTask_modalOverlay__cgzmE",modal:"EmployeeTask_modal__Gyle0",shiftBar:"EmployeeTask_shiftBar__pzGlG",timeTable:"EmployeeTask_timeTable__hRt4i",timeCell:"EmployeeTask_timeCell__eJIjd",shiftTime:"EmployeeTask_shiftTime__NkD_N",editingTimeIndicator:"EmployeeTask_editingTimeIndicator__5crLm",editingTime:"EmployeeTask_editingTime__qfq_N",redText:"EmployeeTask_redText__VqJ1_"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1897)}),_N_E=e.O()}]);